  <div class="container">
    <% if policy(@credit_cards).new? %>
      <%= link_to "Add a credit card", new_credit_card_path, class: "btn btn-primary" %>
    <% end %>


    <table class="table">
    <thead>
      <tr>
        <th>CCN</th>
        <th>Type</th>
        <th>Expiry date</th>
        <th>Cycle's last day</th>
        <th>Status</th>
      </tr>
    </thead>
    <tbody>
        <% @credit_cards.each do |c| %>
      <tr>
        <td><%= c.number %></td>
        <td><%= c.credit_card_type %></td>
        <td><%= c.exp_date %></td>
        <td><%= c.billing_day %></td>
        <td><%= c.status %></td>

        <% if policy(@credit_cards).activate? %>
          <% if c.status == "Closed" %>
            <td></td>
          <% elsif (c.status != "Active") %>
            <td><%= link_to "Activate", activate_credit_card_path(c), method: :patch %></td>
          <% else %>
            <td><%= link_to "Deactivate", deactivate_credit_card_path(c), method: :patch %></td>
          <% end %>

          <% if c.status == "Closed" %>
            <td></td>
          <% else %>
            <td><%= link_to "Edit", edit_credit_card_path(c) %></td>
          <% end %>


          <% if (c.status == "Closed") || (c.status == "Active") %>
            <td></td>
          <% else %>
            <td><button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">Close</button></td>

            <div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h5 class="modal-title" id="exampleModal">Confirmation window</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                  <div class="modal-body">
                    Are you sure you want to close this credit card? You cant open a closed card.
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-primary" data-dismiss="modal">Cancel</button>
                    <button><%= link_to "Yes, I am sure", close_credit_card_path(c), method: :patch, class: "btn btn-danger" %></button>
                  </div>
                </div>
              </div>
            </div>
          <% end %>
        <% end %>
      </tr>
        <% end %>
    </tbody>
  </table>
</div>











